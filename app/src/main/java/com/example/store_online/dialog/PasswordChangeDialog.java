package com.example.store_online.dialog;import android.app.Activity;import android.app.Dialog;import android.graphics.drawable.ColorDrawable;import android.view.Gravity;import android.view.View;import android.view.Window;import android.view.WindowManager;import android.widget.Button;import android.widget.EditText;import androidx.annotation.NonNull;import com.example.store_online.R;import com.google.android.gms.tasks.OnCompleteListener;import com.google.android.gms.tasks.Task;import com.google.firebase.auth.AuthCredential;import com.google.firebase.auth.EmailAuthProvider;import com.google.firebase.auth.FirebaseAuth;import com.google.firebase.auth.FirebaseUser;public class PasswordChangeDialog {    private Activity activity;    private EditText edtOldPass,edtNewPass,edtRePass;    private Button btnYes,btnNo;    public PasswordChangeDialog(Activity myActivity) {        activity = myActivity;    }    public void startAddInforDialog(){        Dialog dialog = new Dialog(activity);        dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);        dialog.setContentView(R.layout.dialog_password_change);        Window window = dialog.getWindow();        if (window == null) {            return;        }        window.setLayout(WindowManager.LayoutParams.MATCH_PARENT, WindowManager.LayoutParams.WRAP_CONTENT);        window.setBackgroundDrawable(new ColorDrawable(0));        WindowManager.LayoutParams windowAtttributes = window.getAttributes();        windowAtttributes.gravity = Gravity.CENTER;        window.setAttributes(windowAtttributes);        btnYes = dialog.findViewById(R.id.btnYes);        btnNo = dialog.findViewById(R.id.btnNo);        edtOldPass = dialog.findViewById(R.id.edt_old_password);        edtNewPass = dialog.findViewById(R.id.edt_new_password);        edtRePass = dialog.findViewById(R.id.edt_re_enter_password);        LoadingDialog loadingDialog = new LoadingDialog(activity);        NotificationDialog notificationDialog =new NotificationDialog(activity);        btnYes.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                String oldPass = edtOldPass.getText().toString().trim();                String newPass = edtNewPass.getText().toString().trim();                String rePass = edtRePass.getText().toString().trim();               if(oldPass.isEmpty()){                   edtOldPass.setError(activity.getResources().getString(R.string.field_empty));               }else if (newPass.isEmpty()){                   edtNewPass.setError(activity.getResources().getString(R.string.field_empty));               }else if(rePass.isEmpty()){                   edtRePass.setError(activity.getResources().getString(R.string.field_empty));               }else if(!rePass.equalsIgnoreCase(newPass)){                   edtRePass.setError(activity.getResources().getString(R.string.field_do_not_match));               }else {                   FirebaseAuth auth=FirebaseAuth.getInstance();                   FirebaseUser user =auth.getCurrentUser();                   AuthCredential credential = EmailAuthProvider                           .getCredential(user.getEmail(), oldPass);                   user.reauthenticate(credential)                           .addOnCompleteListener(new OnCompleteListener<Void>() {                               @Override                               public void onComplete(@NonNull Task<Void> task) {                                   if(task.isSuccessful()){                                       loadingDialog.startLoadingDialog();                                       user.updatePassword(newPass).addOnCompleteListener(new OnCompleteListener<Void>() {                                           @Override                                           public void onComplete(@NonNull Task<Void> task) {                                               if (task.isSuccessful()){                                                   loadingDialog.startLoadingDialog();                                                   dialog.dismiss();                                               }                                               else {                                                   notificationDialog.startErrorDialog(activity.getResources().getString(R.string.PasswordChangeFailed));                                                   dialog.dismiss();                                               }                                           }                                       });                                   }else {                                       notificationDialog.startErrorDialog(activity.getResources().getString(R.string.reAuthentication));                                       dialog.dismiss();                                   }                               }                           });               }            }        });        btnNo.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {               dialog.dismiss();            }        });        dialog.show();    }}